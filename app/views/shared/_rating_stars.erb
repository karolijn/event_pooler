<div>
  <% if reviews.blank?
     5.times{ |i| %><%=image_tag "star_empty.png", :class => "rating_star"%><%}%>
     no reviews yet
     <%
     else
     rank = reviews.sum{|review| review.rank} / reviews.size
     rank.floor.times{ |i| %><%=image_tag "star.png", :class => "rating_star" %><%}
     if rank - rank.floor > 0.49%>
       <%= image_tag "star_half.png" %><%
       (5 - rank.floor + 1).times{ |i| %><%=image_tag "star_empty.png", :class => "rating_star"%><%}
     else
       (5-rank.floor).times{ |i| %><%=image_tag "star_empty.png", :class => "rating_star"%><%}
     end%>
     out of <%= reviews.size %> review(s) <%
  end
  %>
</div>